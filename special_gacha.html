<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ã‚¹ãƒšã‚·ãƒ£ãƒ«ã‚¬ãƒãƒ£</title>

<style>
  body {
    margin: 0;
    font-family: "Kosugi Maru", sans-serif;
    text-align: center;
    background: radial-gradient(circle at top, #fff7d6 0%, #ffe4a8 40%, #f6c46b 100%);
    color: #444;
  }

  #backBtn {
    position: fixed;
    top: 10px;
    left: 10px;
    background: #4c8f3a;
    color: white;
    padding: 10px 18px;
    border-radius: 20px;
    text-decoration: none;
    z-index: 10;
  }

  .header {
    padding: 30px 20px 10px;
  }

  .header h1 {
    margin: 0;
    font-size: 28px;
    color: #c66b00;
    text-shadow: 0 2px 4px rgba(255,255,255,0.8);
  }

  .ticket-box {
    margin-top: 10px;
    font-size: 18px;
    color: #4c8f3a;
  }

  .ticket-num {
    font-size: 24px;
    font-weight: bold;
  }

  /* ã‚¬ãƒãƒ£ã‚¨ãƒªã‚¢ */
  .gacha-area {
    margin-top: 20px;
    padding: 0 20px 30px;
  }

  /* è™¹ã®å…‰ã®è¼ª */
  .circle-bg {
    width: 230px;
    height: 230px;
    margin: 0 auto;
    border-radius: 50%;
    background: conic-gradient(
      from 0deg,
      #ffeb3b,
      #ff9800,
      #f44336,
      #e91e63,
      #9c27b0,
      #3f51b5,
      #2196f3,
      #4caf50,
      #ffeb3b
    );
    display: flex;
    justify-content: center;
    align-items: center;
    box-shadow: 0 0 18px rgba(255,255,255,0.9);
    position: relative;
    overflow: hidden;
  }

  .circle-inner {
    width: 185px;
    height: 185px;
    border-radius: 50%;
    background: radial-gradient(circle, #fffef8 0%, #ffecc2 45%, #f5d190 100%);
    display: flex;
    justify-content: center;
    align-items: center;
  }

  /* åµã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ or ã‚«ãƒ¼ãƒ‰ */
  #egg {
    font-size: 70px;
    transition: transform 0.2s;
  }

  .shake {
    animation: shake 0.5s ease-in-out infinite;
  }

  @keyframes shake {
    0% { transform: translateX(0) rotate(0deg); }
    20% { transform: translateX(-4px) rotate(-3deg); }
    40% { transform: translateX(4px) rotate(3deg); }
    60% { transform: translateX(-3px) rotate(-2deg); }
    80% { transform: translateX(3px) rotate(2deg); }
    100% { transform: translateX(0) rotate(0deg); }
  }

  /* çµæœã‚«ãƒ¼ãƒ‰ */
  .result-card {
    margin-top: 15px;
    background: #fffdf5;
    width: 90%;
    max-width: 360px;
    margin-left: auto;
    margin-right: auto;
    padding: 12px 15px 18px;
    border-radius: 18px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.18);
    border: 3px solid #ffd54f;
    opacity: 0;
    transform: translateY(10px) scale(0.95);
    transition: opacity 0.3s, transform 0.3s;
  }

  .result-card.show {
    opacity: 1;
    transform: translateY(0) scale(1);
  }

  .result-rare {
    font-size: 16px;
    color: #ff9800;
    font-weight: bold;
    margin-bottom: 4px;
  }

  .result-name {
    font-size: 22px;
    color: #c66b00;
    font-weight: bold;
    margin: 4px 0 6px;
  }

  .result-img {
    width: 160px;
    height: 160px;
    object-fit: contain;
  }

  .result-desc {
    font-size: 14px;
    color: #666;
    margin-top: 6px;
  }

  /* æ˜Ÿãã‚‰ãã‚‰ */
  .star {
    position: absolute;
    font-size: 22px;
    opacity: 0;
    animation: twinkle 1.2s ease-out infinite;
  }

  .star.s1 { top: 15%; left: 18%; animation-delay: 0s; }
  .star.s2 { top: 12%; right: 18%; animation-delay: 0.3s; }
  .star.s3 { bottom: 15%; left: 25%; animation-delay: 0.6s; }
  .star.s4 { bottom: 12%; right: 20%; animation-delay: 0.9s; }

  @keyframes twinkle {
    0%   { opacity: 0; transform: scale(0.4) rotate(0deg); }
    40%  { opacity: 1; transform: scale(1.1) rotate(18deg); }
    100% { opacity: 0; transform: scale(0.6) rotate(0deg); }
  }

  /* ãƒœã‚¿ãƒ³ */
  .btn {
    margin-top: 20px;
    padding: 15px 25px;
    font-size: 20px;
    border-radius: 30px;
    border: none;
    color: white;
    background: linear-gradient(135deg, #ff9800, #ff5722);
    box-shadow: 0 4px 10px rgba(0,0,0,0.25);
  }
  .btn:active {
    transform: translateY(2px);
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
  }
  .btn:disabled {
    background: #ccc;
    box-shadow: none;
  }

  .notice {
    margin-top: 10px;
    font-size: 14px;
    color: #555;
  }

  .links {
    margin-top: 20px;
    font-size: 16px;
  }
  .links a {
    color: #4c8f3a;
    text-decoration: none;
    margin: 0 10px;
  }
</style>
</head>

<body>

<a id="backBtn" href="index.html">â† ãƒ›ãƒ¼ãƒ ã¸</a>

<div class="header">
  <h1>ğŸŒˆ ã‚¹ãƒšã‚·ãƒ£ãƒ«ã‚¬ãƒãƒ£ ğŸŒˆ</h1>
  <div class="ticket-box">
    ã‚¹ãƒšã‚·ãƒ£ãƒ«ã‚¬ãƒãƒ£ã‘ã‚“ï¼š<span class="ticket-num" id="ticketNum">0</span> ã¾ã„
  </div>
</div>

<div class="gacha-area">

  <!-- è™¹ã®ä¸¸ã„æ¼”å‡ºï¼‹åµ -->
  <div class="circle-bg">
    <div class="circle-inner">
      <div id="egg">ğŸ¥š</div>
    </div>
    <!-- ãã‚‰ãã‚‰æ˜Ÿ -->
    <div class="star s1">âœ¨</div>
    <div class="star s2">âœ¨</div>
    <div class="star s3">âœ¨</div>
    <div class="star s4">âœ¨</div>
  </div>

  <!-- ã‚¬ãƒãƒ£ãƒœã‚¿ãƒ³ -->
  <button class="btn" id="gachaBtn">ã‚¹ãƒšã‚·ãƒ£ãƒ«ã‚¬ãƒãƒ£ã‚’ã²ã</button>

  <div class="notice" id="noticeText">
    ãƒãƒˆãƒ«ã§ã‹ã£ãŸã‚‰ã€ã“ã“ã§ãƒ¬ã‚¸ã‚§ãƒ³ãƒ‰æç«œãŒæ‰‹ã«å…¥ã‚‹ã‚ˆï¼
  </div>

  <!-- çµæœè¡¨ç¤º -->
  <div class="result-card" id="resultCard">
    <div class="result-rare" id="rareLabel">ãƒ¬ã‚¸ã‚§ãƒ³ãƒ‰</div>
    <div class="result-name" id="charName"></div>
    <img id="charImg" class="result-img" alt="">
    <div class="result-desc" id="charDesc"></div>
  </div>

  <!-- æˆ»ã‚‹ãƒªãƒ³ã‚¯ãªã© -->
  <div class="links">
    <a href="gacha.html">ãµã¤ã†ã®ã‚¬ãƒãƒ£ã¸</a>
    <a href="zukan.html">ãšã‹ã‚“ã‚’ã¿ã‚‹</a>
  </div>

</div>

<script>
/* =========================================
   ãƒ¬ã‚¸ã‚§ãƒ³ãƒ‰æç«œãƒ‡ãƒ¼ã‚¿
========================================= */
const specialChars = [
  {
    id: "gold_tira",
    name: "é‡‘ãƒ†ã‚£ãƒ©ãƒã‚µã‚¦ãƒ«ã‚¹",
    img: "images/legend_gold_tira.png",
    rareLabel: "ğŸŒŸ ãƒ¬ã‚¸ã‚§ãƒ³ãƒ‰",
    desc: "ãã‚“ã´ã‹ãƒœãƒ‡ã‚£ã® ã•ã„ãã‚‡ã†ãƒ†ã‚£ãƒ©ãƒï¼ ãã£ã¨ ã„ã„ã“ã¨ãŒ ãŠã“ã‚‹â€¦ï¼Ÿ",
    weight: 25
  },
  {
    id: "rainbow_pte",
    name: "è™¹è‰²ãƒ—ãƒ†ãƒ©ãƒãƒ‰ãƒ³",
    img: "images/legend_rainbow_pte.png",
    rareLabel: "ğŸŒˆ ãƒ¬ã‚¸ã‚§ãƒ³ãƒ‰",
    desc: "ãã‚‰ã‚’ ã‹ã‘ã‚ãã‚‹ ã«ã˜ã„ã‚ã® ã¤ã°ã•ã€‚ ã¿ã‚“ãªã®ã‚†ã‚ã‚’ ã¯ã“ã¶ã‚ˆã€‚",
    weight: 25
  },
  {
    id: "aura_bra",
    name: "ã‚ªãƒ¼ãƒ©ãƒ–ãƒ©ã‚­ã‚ªã‚µã‚¦ãƒ«ã‚¹",
    img: "images/legend_aura_bra.png",
    rareLabel: "âœ¨ ãƒ¬ã‚¸ã‚§ãƒ³ãƒ‰",
    desc: "ã‚„ã•ã—ã„ã‚ªãƒ¼ãƒ©ã§ ã¿ã‚“ãªã‚’ã¾ã‚‚ã‚‹ ãŠãŠããªãƒ–ãƒ©ã‚­ã‚ªã€‚",
    weight: 25
  },
  {
    id: "fire_tira",
    name: "ç‚ãƒ†ã‚£ãƒ©ãƒã‚µã‚¦ãƒ«ã‚¹",
    img: "images/legend_fire_tira.png",
    rareLabel: "ğŸ”¥ ãƒ¬ã‚¸ã‚§ãƒ³ãƒ‰",
    desc: "ã‚ã‚‰ã‚ã‚‰ã‚‚ãˆã‚‹ ã»ã®ãŠã®ãƒ†ã‚£ãƒ©ãƒã€‚ ã‚„ã‚‹ãã¾ã‚“ã¾ã‚“ï¼",
    weight: 25
  }
];

/* =========================================
   ãƒã‚±ãƒƒãƒˆæšæ•°ã®å–å¾—ãƒ»è¡¨ç¤º
========================================= */
let ticket = Number(localStorage.getItem("specialTicket") || 0);
const ticketNumEl = document.getElementById("ticketNum");
const gachaBtn = document.getElementById("gachaBtn");
const eggEl = document.getElementById("egg");
const resultCard = document.getElementById("resultCard");
const noticeText = document.getElementById("noticeText");

function updateTicketView() {
  ticketNumEl.textContent = ticket;
  if (ticket <= 0) {
    gachaBtn.disabled = true;
    noticeText.textContent = "ã‚¹ãƒšã‚·ãƒ£ãƒ«ã‚¬ãƒãƒ£ã‘ã‚“ãŒ ãªã„ã‚ˆã€‚ãƒãƒˆãƒ«ã«ã‹ã£ã¦ ã‚‚ã‚‰ãŠã†ï¼";
  } else {
    gachaBtn.disabled = false;
    noticeText.textContent = "ã‚¹ãƒšã‚·ãƒ£ãƒ«ã‚¬ãƒãƒ£ã‘ã‚“ã‚’ ã¤ã‹ã£ã¦ ãƒ¬ã‚¸ã‚§ãƒ³ãƒ‰æç«œã‚’ã¦ã«ã„ã‚Œã‚ˆã†ï¼";
  }
}
updateTicketView();

/* =========================================
   æ‰€æŒã‚­ãƒ£ãƒ©ï¼ˆownedï¼‰ç®¡ç†
========================================= */
function addOwned(id) {
  let owned = JSON.parse(localStorage.getItem("owned") || "[]");
  if (!owned.includes(id)) {
    owned.push(id);
    localStorage.setItem("owned", JSON.stringify(owned));
  }
}

/* =========================================
   æŠ½é¸ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆé‡ã¿ä»˜ããƒ©ãƒ³ãƒ€ãƒ ï¼‰
========================================= */
function drawSpecialChar() {
  const total = specialChars.reduce((sum, c) => sum + c.weight, 0);
  const r = Math.random() * total;
  let acc = 0;
  for (const c of specialChars) {
    acc += c.weight;
    if (r <= acc) return c;
  }
  return specialChars[0]; // ä¿é™º
}

/* =========================================
   ã‚¬ãƒãƒ£ãƒœã‚¿ãƒ³æŠ¼ä¸‹
========================================= */
let isRolling = false;

gachaBtn.addEventListener("click", () => {
  if (isRolling) return;
  if (ticket <= 0) return;

  isRolling = true;

  // ãƒã‚±ãƒƒãƒˆæ¶ˆè²»
  ticket--;
  localStorage.setItem("specialTicket", ticket);
  updateTicketView();

  // æ¼”å‡ºï¼šåµã‚’æºã‚‰ã™
  resultCard.classList.remove("show");
  eggEl.textContent = "ğŸ¥š";
  eggEl.classList.add("shake");

  // ã¡ã‚‡ã£ã¨å¾…ã£ã¦ã‹ã‚‰çµæœã‚’å‡ºã™
  setTimeout(() => {
    eggEl.classList.remove("shake");

    const char = drawSpecialChar();

    // æ‰€æŒã«è¿½åŠ 
    addOwned(char.id);

    // åµ â†’ ã‚­ãƒ©ã‚­ãƒ©ã«å¤‰åŒ–
    eggEl.textContent = "âœ¨";

    // çµæœã‚«ãƒ¼ãƒ‰è¡¨ç¤º
    document.getElementById("rareLabel").textContent = char.rareLabel;
    document.getElementById("charName").textContent = char.name;
    document.getElementById("charImg").src = char.img;
    document.getElementById("charImg").alt = char.name;
    document.getElementById("charDesc").textContent = char.desc;

    resultCard.classList.add("show");
    isRolling = false;
  }, 1400);
});
</script>

</body>
</html>
